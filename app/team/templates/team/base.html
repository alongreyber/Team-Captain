{% extends 'base.html' %}

{% block nav %}
<div class="navbar is-info">
    <div class="navbar-menu is-active">
	<div class="navbar-item has-dropdown" id="settings-dropdown">
	    <div class="navbar-link has-text-white has-text-weight-bold" {{helpers.toggle_active('settings-dropdown')}}>
		{{g.team.name}} - {{g.team.number}}
	    </div>
	    <div class="navbar-dropdown is-boxed is-size-5" style='margin-top: 5px'>
		{% if current_user.is_admin() %}
		    <a class="navbar-item" href="{{team_url_for('admin.team_settings')}}" >Admin Settings</a>
		{% endif %}
		<a class="navbar-item" href="{{team_url_for('team.edit_profile')}}">User Settings</a>
	    </div>
	</div>
	<div class="navbar-start">
	    <a href="{{team_url_for('team.user_profile')}}" class="navbar-item {{ "is-active" if request.path.startswith('/profile') }}">
		Profile
	    </a>
	    <a href="{{team_url_for('team.task_list')}}" class="navbar-item {{ "is-active" if request.path.startswith('/task') }}">
		Tasks
	    </a>
	    <a href="{{team_url_for('team.calendar_home')}}" class="navbar-item {{ "is-active" if request.path.startswith('/calendar') }}">
		Events
	    </a>
	    <a href="{{team_url_for('team.wiki_home')}}" class="navbar-item {{ "is-active" if request.path.startswith('/wiki') }}">
		Wiki
	    </a>
	    <a href="{{team_url_for('team.assignment_list')}}" class="navbar-item {{ "is-active" if request.path.startswith('/assignment') }}">
		Assignments
	    </a>
	    <a href="{{team_url_for('team.user_list')}}" class="navbar-item {{ "is-active" if request.path.startswith('/user') }}">
		Team Directory
	    </a>
	</div>
	<div class="navbar-end">
	    <div id="notification-dropdown" class="navbar-item has-dropdown {% if session['open-notifications'] %}{{ session.pop('open-notifications') }} is-active{% endif %}">
		<a class="navbar-link is-arrowless " {{helpers.toggle_active('notification-dropdown')}}>
		    {% if current_user.notifications|length == 0 %}
		    <span class="icon is-medium badge">
		    {% else %}
		    <span class="icon is-medium badge has-badge-rounded is-badge-small" data-badge="{{current_user.notifications|length}}" style="margin-right: 4px">
		    {% endif %}
			<i class="fas fa-bell fa-lg"></i>
		    </span>
		</a>
		<div class="navbar-dropdown">
		    {% if current_user.notifications|length == 0 %}
		    	<a class="navbar-item">
			    All caught up!
			</a>
		    {% else %}
			{% for n in current_user.notifications %}
			    <div class="navbar-item tc-notification" >
				<a class="tc-notification__content" href="{{ team_url_for('team.notification_redirect', id=n.id) }}">
				    {{ n.text }}
				</a>
				<a href="{{ team_url_for('team.notification_dismiss', id=n.id )}}" class="tc-notification__dismiss">
				    <span class="icon is-medium badge">
					<i class="fas fa-minus-square fa-lg"></i>
				    </span>
				</a>
			    </div>
			{% endfor %}
		    {% endif %}
		</div>
	    </div>
	    <div class="navbar-item">
		Welcome {{current_user.name}}
	    </div>
	    <div class="navbar-item">
		<a href="{{team_url_for('logout')}}">
		    <button class="button is-link">
			Sign Out
		    </button>
		</a>
	    </div>
	</div>
    </div>
</div>
{% endblock %}

{% block content %}
{% block team_content %}{% endblock %}
{% endblock %}

