{% import 'helpers.html' as helpers %}
{% extends 'public/calendar/base.html' %}

{% block calendar_content %}
<div class="level">
    <div class="level-left">
	<h1 class="level-item title is-1">{{calendar.name}}</h1>
    </div>
    <div class="level-right">
	{% if calendar.permissions.check_editor(current_user) %}
	<a href="{{url_for('public.calendar_edit', id=calendar.id)}}" class="level-item icon is-large">
	    <i class="fas fa-edit fa-2x"></i>
	</a>
	{% endif %}
    </div>
</div>


<p class="is-size-4">{{calendar.description}}</p>
<br/>
<h5 class="is-size-5"> Owner: {{ calendar.owner.name }}
<br/>
<br/>

<div class='columns'>
    <div class="column">
	<h3 class="title is-3">Editors</h3>
	{% for r in calendar.permissions.editor_roles %}
	<div class="button is-rounded is-primary">{{r.name | capitalize}}</div>
	{% endfor %}
	{% for u in calendar.permissions.editor_users %}
	<div class="button is-rounded is-link">{{u.first_name + " " + u.last_name}}</div>
	{% endfor %}
    </div>
    <div class="column">
	<h3 class="title is-3">Visible To</h3>
	{% for r in calendar.permissions.visible_roles %}
	<div class="button is-rounded is-primary">{{r.name | capitalize}}</div>
	{% endfor %}
	{% for u in calendar.permissions.visible_users %}
	<div class="button is-rounded is-link">{{u.first_name + " " + u.last_name}}</div>
	{% endfor %}
    </div>
</div>

<div class="is-divider" ></div>
<h3 class="title is-3">Events</h3>
<table class="table is-hoverable">
    <thead>
	<tr>
	    <th>Name</th>
	    <th>Date</th>
	    <th>Time</th>
	</tr>
    </thead>
    <tbody>
	{% for event in events %}    
	<tr {{helpers.onclick(url_for('public.scheduled_event_view', cid=calendar.id, id=event.id))}}>
	    <td>
		{{event.name}}
	    </td>
	    <td>
		{{event.start|localize|format('MM/DD/YY')}}
	    </td>
	    <td class="has-text-centered">
		{{event.start|localize|format('hh:mm A')}} - 
		{{event.end|localize|format('hh:mm A')}}
	    </td>
	</tr>
	{% endfor %}
    </tbody>
</table>


{% if calendar.permissions.check_editor(current_user) %}
<a class="button is-primary" href="{{url_for('public.scheduled_event_new', id=calendar.id)}}" >New Event</a>
{% endif %}
<br />
{% endblock %}
