{% extends 'admin/base.html' %}

{% block admin_content %}
<div class="level">
    <div class="level-left">
	<h1 class="title level-item">Task Info</h1>
    </div>

    <div class="level-right">
	{% if task.due > now %}
	<div class="level-item button is-outlined is-success">
	    In Progress
	</div>
	{% else %}
	<div class="level-item button is-outlined is-danger">
	    Past Due
	</div>
	{% endif %}
    </div>
</div>

<h5 class="title is-5">Subject</h5>
<p>{{task.subject}}</p>
<br />

<h5 class="title is-5">Due Date</h5>
<p>{{task.due.strftime('%a %B %d')}}</p>
<br />


<h5 class="title is-5">Content</h5>
<div class="is-size-5" id="editor" style="height: 200px"></div>
<script>
    $(document).ready(function() {
	var quill = new Quill('#editor', {
	    theme: 'snow',
	    modules: {
		toolbar: false
	    },
	    readOnly: true,
	});
	// Load contents from server
	var delta = JSON.parse({{task.content|safe}});
	quill.setContents(delta);
    });
</script>

<br />
<h5 class="title is-5">Assigned Users</h5>
<table class="table">
    <thead>
	<th>User Name</th>
	<th>Seen</th>
	<th>Completed?</th>
    </thead>
    <tbody>
	{% for user in assigned_users %}
	<tr>
	    <td>
		<a href="{{url_for('admin.user_info', id=user.id)}}">
		    {{user.first_name}} {{user.last_name}}
		</a>
	    </td>
	    <td>{% if user.assigned_tasks[0].seen      %}Yes{% else %}No{% endif %}</td>
	    <td>{% if user.assigned_tasks[0].completed %}Yes{% else %}No{% endif %}</td>
	</tr>
	{% endfor %}
    </tbody>
</table>

<a href="{{url_for('admin.task_delete', id=task.id)}}" class="button is-danger">
    Delete
</a>
<a href="{{url_for('admin.task_duplicate', id=task.id)}}" class="button is-primary">
    Make a Copy
</a>

{% endblock %}
